<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantumTech PCs</title>
    <style>
        /* ... (keep your existing styles) ... */
        .error { color: red; }
        #telegramResponse { margin-top: 10px; }
    </style>
</head>
<body>
    <!-- ... (keep your existing HTML) ... -->

    <script>
        // CONFIGURATION ============================================
        const botToken = '7354330025:AAGeHcMeDs70cBvZpfMbz88hCg5ysaEL5oY';
        const chatId = '-1002320071203'; // REQUIRED: Replace with your actual chat ID
        
        // TEST YOUR BOT FIRST ======================================
        async function testBotConnection() {
            try {
                const testMsg = "ðŸ”§ BOT CONNECTION TEST\n\nThis is a test message from your landing page";
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: testMsg
                    })
                });
                
                const result = await response.json();
                console.log("Bot test result:", result);
                
                if (!response.ok) throw new Error(result.description || 'Unknown error');
                alert("Bot connection successful! Check Telegram.");
            } catch (error) {
                console.error("Bot test failed:", error);
                alert(`Bot test failed: ${error.message}\n\nCheck:\n1. Correct chat ID\n2. Bot token\n3. Internet connection`);
            }
        }
        
        // RUN THIS TEST MANUALLY IN CONSOLE FIRST
        // testBotConnection(); 

        // FORM SUBMISSION ==========================================
        document.getElementById('codForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const responseDiv = document.createElement('div');
            responseDiv.id = 'telegramResponse';
            e.target.appendChild(responseDiv);
            
            submitBtn.disabled = true;
            responseDiv.textContent = "Sending...";
            responseDiv.className = "";
            
            try {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData.entries());
                
                // Format message
                const message = `ðŸ›’ NEW ORDER:\n\n` +
                               `Product: ${data.product}\n` +
                               `Name: ${data.name}\n` +
                               `Phone: ${data.phone}\n` +
                               `Email: ${data.email || 'N/A'}\n` +
                               `Address: ${data.address}\n` +
                               `Quantity: ${data.quantity}`;
                
                // Send to Telegram
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                console.log("Telegram API response:", result);
                
                if (!response.ok) {
                    throw new Error(result.description || 'Telegram API error');
                }
                
                responseDiv.textContent = "âœ“ Order sent successfully!";
                responseDiv.className = "success";
                e.target.reset();
                
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.getElementById('successMessage').style.display = 'block';
                }, 1000);
                
            } catch (error) {
                console.error("Submission error:", error);
                responseDiv.textContent = `Error: ${error.message}`;
                responseDiv.className = "error";
            } finally {
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
